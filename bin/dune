(env
 (release-static
  (flags
   (-ccopt -static))))

(data_only_dirs npm-bin-wrapper-dev)

(executable
 (name esy)
 (public_name esy)
 (preprocessor_deps "npm-bin-wrapper-dev/binary_wrapper.ml")
 (preprocess
  (pps ppx_blob lwt_ppx ppx_let ppx_deriving_yojson ppx_deriving.std))
 (flags
  (:standard
   (-w -39)
   "-open"
   "EsyLib"))
 (libraries lwt lwt.unix esy_cmdliner esy_logs esy_logs_fmt esy_logs_lwt
   esy_logs_cli esy_fmt esy_fmt_cli esy_fmt_tty str astring
   ppx_deriving_yojson.runtime EsyBuild EsyFetch EsySolve EsyVersion))

(install
 (package esy)
 (section bin)
 (files
  (esyInstallRelease.js as esyInstallRelease.js)))
