"use strict";(self.webpackChunksite_v_3=self.webpackChunksite_v_3||[]).push([[4961],{7628:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>c});var t=s(5893),i=s(1151);const l={id:"esy-installer",title:"esy-installer",authors:["prometheansacrifice"]},a=void 0,o={id:"esy-installer",title:"esy-installer",description:"OPAM packages follow a convention of emitting .install files so that",source:"@site/../docs/esy-installer.md",sourceDirName:".",slug:"/esy-installer",permalink:"/docs/esy-installer",draft:!1,unlisted:!1,editUrl:"https://github.com/esy/esy/tree/master/docs/../docs/esy-installer.md",tags:[],version:"current",lastUpdatedBy:"prometheansacrifice",lastUpdatedAt:1725276666,formattedLastUpdatedAt:"Sep 2, 2024",frontMatter:{id:"esy-installer",title:"esy-installer",authors:["prometheansacrifice"]},sidebar:"docs",previous:{title:"Offline Builds",permalink:"/docs/offline"},next:{title:"How esy works",permalink:"/docs/contributing/how-it-works"}},r={},c=[];function d(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["OPAM packages follow a convention of emitting ",(0,t.jsx)(n.code,{children:".install"})," files so that\npackage managers can install the built\nartifacts. ",(0,t.jsx)(n.a,{href:"https://opam.ocaml.org/packages/opam-installer/",children:(0,t.jsx)(n.code,{children:"opam-installer"})}),"\nis one such example. Thus, ",(0,t.jsx)(n.code,{children:"esy"})," is responsible for reading ",(0,t.jsx)(n.code,{children:".install"}),"\nfiles and installing the built artifacts correctly. ",(0,t.jsx)(n.code,{children:"esy-installer"})," is\nan internal command, ie available only while creating esy recipes,\nthat can read ",(0,t.jsx)(n.code,{children:".install"})," files and install them in the sandbox."]}),"\n",(0,t.jsxs)(n.p,{children:["By default, if a package creates one ",(0,t.jsx)(n.code,{children:".install"})," file, esy\nautomatically runs ",(0,t.jsx)(n.code,{children:"esy-install"})," files internall. However, in some\ncustomised setups, eg, ",(0,t.jsx)(n.a,{href:"https://github.com/reasonml/reason-native/blob/master/rely.json#L27",children:"reason-native"}),", it's necessary to specify\nhow the built artifacts are installed."]}),"\n",(0,t.jsx)(n.p,{children:"Here's another example."}),"\n",(0,t.jsxs)(n.p,{children:["While overriding ",(0,t.jsx)(n.code,{children:"@opam/unison"})," with the following,"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'    "@opam/unison": {\n      "version": "opam:2.53.4",\n      "override": {\n        "buildsInSource": "_build",\n        "buildEnv": {\n          "HOME": "#{$cur__install}",\n          "OSTYPE": "#{os == \'windows\' ? \'cygwin\': \'\'}",\n          "OSARCH": "#{os == \'windows\' ? \'win32\': \'\'}",\n          "CC": "#{os == \'windows\' ? \'x86_64-w64-mingw32-gcc.exe\': \'gcc\'}"\n        },\n        "build": "dune build -p unison",\n        "install": "esy-installer ./unison.install",\n        "dependencies": {\n          "@opam/dune": "*",\n          "ocaml": "*"\n        }\n      }\n    }\n'})}),"\n",(0,t.jsxs)(n.p,{children:["it was necesary to specify ",(0,t.jsx)(n.code,{children:"esy-installer ..."})," command since ",(0,t.jsx)(n.code,{children:"unison"})," package contained multiple ",(0,t.jsx)(n.code,{children:".install"})," files after the build."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"esy-installer"})," is kind of like ",(0,t.jsx)(n.code,{children:"dune install"})," command, except that it was written with esy's sandbox in mind."]})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>o,a:()=>a});var t=s(7294);const i={},l=t.createContext(i);function a(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);